<Window x:Class="MMC_Software.VentanaBuscarDocumentos"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MMC_Software"
        xmlns:sys="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d"
        Title="VentanaBuscarDocumentos" Height="500" Width="900"
        WindowStartupLocation="CenterScreen">
    <Border Background="#34495E" Padding="10">
        <GroupBox FontSize="18" FontFamily="Tahoma"
                  Foreground="White" HorizontalContentAlignment="Center">
            <StackPanel Margin="10">

                <!-- Título -->
                <TextBlock Text="Buscador Documento" 
                           FontSize="25" 
                           HorizontalAlignment="Center"
                           Margin="0 0 0 15"/>

                <!-- Filtros principales -->
                <StackPanel Orientation="Horizontal" Margin="0 0 0 10">
                    <TextBlock Text="Desde:" Margin="3" VerticalAlignment="Center"/>
                    <DatePicker x:Name="dpDesde" IsTodayHighlighted="True" 
                                Margin="5" SelectedDate="{x:Static sys:DateTime.Now}" Width="130"/>
                    <TextBlock Text="Hasta:" Margin="15 5 5 5" VerticalAlignment="Center"/>
                    <DatePicker x:Name="dpHasta" IsTodayHighlighted="True" Width="130"
                                Margin="5" SelectedDate="{x:Static sys:DateTime.Now}"/>
                    <TextBlock Text="Nit/Cédula:" Margin="15 5 5 5" VerticalAlignment="Center"/>
                    <TextBox x:Name="TxtFiltroNitCC" Width="100" Height="25" Margin="4" KeyDown="TxtFiltroNitCC_KeyDown"/>
                    <TextBox x:Name="TxtNombres" Width="200" Height="24" Margin="5"></TextBox>
                </StackPanel>

                <!-- Etiquetas criterios -->
                <StackPanel Orientation="Horizontal" Margin="0 0 0 5">
                    <TextBlock Text="Criterio búsqueda" Margin="5"/>
                    <TextBlock Text="Código Documento:" Margin="50 5 5 5"/>
                    <TextBlock Text="Número Documento:" Margin="50 5 5 5"/>
                </StackPanel>

                <!-- Controles criterios -->
                <StackPanel Orientation="Horizontal" Margin="0 0 0 15">
                    <ComboBox x:Name="CmbFiltroCriterioBusqueda" Width="200" Height="24" Margin="5" HorizontalContentAlignment="Center"/>

                    <!-- TextBox con buscador tipo autocomplete -->
                    <StackPanel Orientation="Vertical" Width="250" Margin="5">
                        <TextBox x:Name="TxtFiltroDocumento" 
                                 Width="350"
                                 Height="25"
                                 Margin="5" 
                                 TextChanged="TxtFiltroDocumento_TextChanged"/>
                        <!-- Popup para que el ListBox no dañe el diseño -->
                        <Popup x:Name="PopupDocumentos"
                               PlacementTarget="{Binding ElementName=TxtFiltroDocumento}"
                               Placement="Bottom"
                               StaysOpen="False">
                            <Border BorderBrush="Gray" BorderThickness="1" Background="White">
                                <ListBox x:Name="LstFiltroDocumento"
                                         Width="300"
                                         Height="100"
                                         Background="White"
                                         Foreground="Black"
                                         FontFamily="Tahoma"
                                         DisplayMemberPath="Nombre"
                                         SelectionChanged="LstFiltroDocumento_SelectionChanged"/>
                            </Border>
                        </Popup>
                    </StackPanel>

                    <TextBox x:Name="TxtFiltroNumeroDocumento" Width="100" Margin="5" Height="24" 
                             PreviewTextInput="TxtFiltroNumeroDocumento_PreviewTextInput"/>
                    <Button x:Name="BtnBuscar" Width="80" Content="Buscar" Margin="10 0 0 0" Click="BtnBuscar_Click"/>
                </StackPanel>

                <!-- DataGrid -->
                <DataGrid x:Name="dgListadoFacturas" 
                          AutoGenerateColumns="False"
                          HeadersVisibility="Column"
                          Margin="0 0 0 15"
                          FontFamily="Tahoma"
                          IsReadOnly="True"
                          RowHeight="24"
                          Height="200"
                          FontSize="15"
                          SelectedCellsChanged="dgListadoFacturas_SelectedCellsChanged">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Docto" Binding="{Binding Docto}" Width="60"/>
                        <DataGridTextColumn Header="Número" Binding="{Binding NumeroDocto}" Width="80"/>
                        <DataGridTextColumn Header="Fecha" Binding="{Binding Fecha , StringFormat={}{0:yyyy-MM-dd}}" Width="100"/>
                        <DataGridTextColumn Header="Nit/CC" Binding="{Binding NitCC}" Width="120"/>
                        <DataGridTextColumn Header="Nombres" Binding="{Binding Nombres}" Width="200"/>
                        <DataGridTextColumn Header="Items" Binding="{Binding Items}" Width="40"/>
                        <DataGridTextColumn Header="Total Venta" Binding="{Binding TotalVenta, StringFormat=C}" Width="150"/>
                        <DataGridTextColumn Header="FormaPago" Binding="{Binding FormaPago}" Width="100"/>
                    </DataGrid.Columns>
                </DataGrid>
            </StackPanel>
        </GroupBox>
    </Border>
</Window>
